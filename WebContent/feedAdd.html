<html>
	<head>
		<script type="text/javascript" src="js/jquery-3.6.0.min.js"></script>
		<meta name=viewport content="width=device-width, initial-scale=1, user-scalable=0">
		<meta charset="utf-8" />
		<link rel="stylesheet" href="css/core.css">
		<title>MySNS</title>
	</head>
		<body>
		

		 <SELECT id=type>
         <OPTION VALUE=sell>sell</OPTION>
         <OPTION VALUE=buy>buy</OPTION>
         </SELECT>
      
 		
         
         <div class="start_date">거래희망 시작 날</div>
        <input type="date" id="start" 
       value="xxxx-xx-xx"
       min="2021-01-01" max="2022-12-31">
       
       
       <div class="end_date">거래희망 종료 날</div>
       <input type="date" id="end" 
       value="xxxx-xx-xx"
       min="2021-01-01" max="2022-12-31">
         
         
		<textarea id="content" onfocus="this.placeholder='이곳에 글을 작성해 주세요'"></textarea>
		
		
		
		<div>거래 대상의 성별을 선택해주세요</div>
		 <SELECT id=trader>
         <OPTION VALUE=남성>man</OPTION>
         <OPTION VALUE=여성>woman</OPTION>
         <OPTION VALUE=성별무관>no</OPTION>
         </SELECT>
      	<input id="price" type="text"> <span>원</span>
		<div class="desc">아래에서 이미지를 선택해주세요.</div>
		
		<input id="image" type="file">	
		
		
		

<input type="submit"  value="업로드하기" onclick="upload()">

</body>
</html>


<script src="js/jquery-3.6.0.min.js"></script>
<script src="js/core.js"></script>

<script>
			$(document).ready(function() {
				Page.init(setup);	
			});
			var loginId = null;
			function setup(uid){
				loginId = uid;
			}

			
			
			function upload() {
			id = loginId;
			
			var start = $("#start").val().trim();
			if (start == "") {
			alert("거래 시작 날을 입력해주세요.");
			$("#start").focus();
			return;
			}
			
			var end = $("#end").val().trim();
			if (end == "") {
			alert("거래 종료 날을 입력해주세요.");
			$("#end").focus();
			return;
			}
			
			var type = $("#type").val().trim();
			if (type == "") {
			$("type").focus();
			return;
			}
			var price = $("#price").val().trim();
			if (price == "") {
			alert("1박당 희망 가격을 적어주세요.");
			$("#price").focus();
			return;
			}
			
			var content = $("#content").val().trim();
			if (content == "") {
			alert("작성글을 입력해 주세요.");
			$("#content").focus();
			return;
			}
			
			
			
			var trader = $("#trader").val().trim();
			if (trader == "") {
			$("#trader").focus();
			return;
			}
			
			
			var imgobj = $("#image")[0].files[0];
			var jsonobj = {id: id, type: type, start:start, end:end,price:price, trader:trader, content: content, ts: getTime()};
			if (imgobj != null) {
				jsonobj.images = [imgobj.name];
			}
			
			var params = new FormData();
			params.append("jsonstr", JSON.stringify(jsonobj));
			if (imgobj != null) {
			params.append("image", imgobj);
			}
			var url = "jsp/feedAdd.jsp";
			AJAX.call(url, params, function(data) {	
			
			var code = data.trim();
			if (code == "ER") {
			alert("작성 글의 업로드 중 오류가 발생하였습니다.");
			}
			else {
			alert("작성 글의 업로드가 완료되었습니다.");
			window.location.href = "main.html";
			}
			}, true);
			}
			 
			function getTime() {
			var date = new Date();
			var year = date.getFullYear();
			var month = ("0" + (1 + date.getMonth())).slice(-2);
			var day = ("0" + date.getDate()).slice(-2);
			var hour = ("0" + date.getHours()).slice(-2);
			var min = ("0" + date.getMinutes()).slice(-2);
			var sec = ("0" + date.getSeconds()).slice(-2);
			return year + "-" + month + "-" + day + " " + hour + ":" + min + ":" + sec;
			}
			</script>