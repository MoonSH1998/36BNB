<html>
<head>
<meta name=viewport content="width=device-width, initial-scale=1, user-scalable=0">
<meta charset="utf-8" />
<link rel="stylesheet" href="css/core.css">
<title>MySNS</title>
</head>
<body>
    <header class="need-screen-header"> 
		<a class="back_icon" href ="main.html">
			<img src="img/back_arrow.svg">
		</a>
        
        <span class="need_title"> 내 계정	</span>
		
		<a class="search_icon menu_icon" href ="#">
			<i class="fas fa-ellipsis-h"></i>
		</a>
	</header>
	
	<div class="line"></div>
	
	<div id="myPhoto"></div>
	
	<div id="name"></div>
	<div id="stu_num"></div>
	
	<div>
		<div id="myFeed">내가 쓴 글</div>
		<div id="myReview">받은 후기</div>
		<div id="heart">찜한 글</div>
	</div>
		
  			<img class="profileImg"src="images/profile_def.svg" alt="프로필 이미지">
  			
  			<div><a a href ="jsp/logout.jsp">로그아웃</a></div>

  					
			
	<div id="list"></div>
 <nav class="nav">
			<ul class="nav__list">
				<li class="nav__btn"> 
					<a class="nav__link" href="main.html">
						<i class="fas fa-home"></i>
						<span>홈</span>
					</a>
				</li>
				<li class="nav__btn">
					<a class="nav__link blue" href="need.html">
						<i class="fas fa-search"></i>
						<span>구해요</span>
					</a>
				</li>
				<li class="nav__btn">
					<a class="nav__link" href="sell.html">
						<i class="fas fa-tag blue"></i>
						<span class="blue">내놔요</span>
					</a>
				</li>
				<li class="nav__btn">
					<a class="nav__link" href="profile.html">
						<i class="far fa-user"></i>
						<span>내 계정</span>
					</a>
				</li>
			</ul>
		</nav>


		</body>
		</html>
		<script src="js/jquery-3.6.0.min.js"></script>
		<script src="js/core.js"></script>
		<script>
		
		$(document).ready(function() {
			Page.init(start);
			});
		
		var userObj = null;
		
		function start(uid) {
			var params = {id : uid};
			AJAX.call("jsp/userGet.jsp", params, function(data) {
			userObj = JSON.parse(data.trim());
			setPage(userObj);
			console.log(userObj.id);
			showPhoto(userObj);
			AJAX.call("jsp/feedlist.jsp", null, function(data) {
				var feeds = JSON.parse(data.trim());
	
			countMyFeed(feeds, userObj);
			});	
		});
	}
		
		function countMyFeed(feed, user) {
			var count = 0;
			console.log(user.id);
			for (var i=0; i<feed.length; i++) {
				if(feed[i].id == user.id){
					count++;	
				}
			}
			$("#myFeed").append(count);
		}
		
		function showPhoto(uobj){
			if (uobj.images == null){
				var str = "<img class='userPhoto' onclick='fixPhoto()'";
				   str += "style='background-size : contain; background-repeat: no-repeat; background-position:center; width : 100px; height : 100px;' src=\"img/uimg.png\">";
				//no_img css작업..+ onclick=> 이미지 추가 작업.
			}
			else{
			var userimgurl = "img/" + uobj.images;
			var str = "<div class = 'userPhoto' onclick='fixPhoto' ";
			   str += "style='background-size : contain; background-repeat: no-repeat; background-position: center center; background-size: 100%; background-image: url(\"" + userimgurl + "\")'>";
			   str += "</div>"
			}
			
			$("#myPhoto").append(str);
			console.log(str);
		}
		
		function fixPhoto(){
			alert("사진 수정 기능 추가중");
		}
		
		function setPage(uobj) {
			if (uobj == null) return;
			$("#id").html(uobj.id);
			$("#name").html(uobj.name);
			$("#stu_num").html(uobj.stu_num);
			
		}
	
	
</script>
	
 <script>
 	src="https://kit.fontawesome.com/6478f529f2.js";
 	crossorigin="anonymous"
 </script>